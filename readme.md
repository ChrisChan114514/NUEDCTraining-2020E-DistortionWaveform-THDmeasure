# NUEDC 2020年E题-放大器非线性失真研究装置 方案实现说明

## 整体思路

### 硬件

主要是参考了2020年的钟学长的方案，就是第一级共射单管放大至2~3Vpp，然后过**RC低通（注意原参考方案是没有RC的，因为三极管自激实在太离谱，不加不行（血的教训））**，然后通过电阻分压，大概100mVpp以下幅值进第二级单管放大，
然后调节继电器（其实拨码开关更好），接入不同电阻调节工作点和第二级幅值输入，实现不同失真。至于第三级主要是B类功放短接二极管用不失真出交越失真，但是第4天可以，第5天的时候又没了，真出生，最后是不失真运放抬升放大
后，然后再进B类功放出交越（逆天）。 第三级B类出完，就是进集成运放，因为不同波形有不同幅值、工作点（均值），不同波形要不同的抬升/放大，因此用了5个同相加法放大器，利用拨码开关调整通路。
最后再用开关选择信号，实现一个输入口，一个输出口。

## 软件
感觉大一的都能写，无非FFT运算然后能量简单集中一下，THD就测出了（用方波三角波验证了，误差0.5%以内，其他波没有失真仪不太方便搞），不多赘述了。（唯一逆天的是按键开关中断进不去，最后是用主线程定时扫描开关状态，逆天）

##文件说明
两个验证文件夹，其实没啥用，仿真的都是比较垃圾（完全不准）。SUM是STM32F4的代码，还有硬件的照片（设计图懒得画了）。

## 体悟
参考的这个方案我们学过模电看起来很简单，**但是实现的调试过程中非常艰辛**（共计5天硬件工作点/波形调试，每天调试都是10小时起步，软件2个小时）。
然后也是反复爆炸，一会儿这个波出了，但是另一个又没了（感觉还是要用洞洞板制作，不建议PCB）。**最逆天的是第四天波形全出了，第二天早上全没了（怀疑是继电器工作不良），花了一天又全部调好**。还有仿真屁用没有（除了第一级单管放大），什么自激
都不会有仿真考虑，但是实际调试2M的自激都来过。 总之这题比想象中的困难，但是在实际调试中，会越来越有经验，真的是磨性子(还有焊膏的毒气吸了不少)...很累了，先回家玩个三天...
